<!DOCTYPE html>












  


<html class="theme-next gemini use-motion" lang="zh-CN">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2"/>
<meta name="theme-color" content="#222">












<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />






















<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=6.3.0" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=6.3.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=6.3.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=6.3.0">


  <link rel="mask-icon" href="/images/logo.svg?v=6.3.0" color="#222">









<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '6.3.0',
    sidebar: {"position":"right","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="crypto题差一题AK--（中）">
<meta name="keywords" content="ctf,Jarvis OJ,writeup,crypto">
<meta property="og:type" content="article">
<meta property="og:title" content="Jarvis OJ -- crypto题（中）">
<meta property="og:url" content="https://4Five.github.io/2017/12/01/Jarvis_crypto_2/index.html">
<meta property="og:site_name" content="4Five&#39;S BLOG">
<meta property="og:description" content="crypto题差一题AK--（中）">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="http://oztni9daw.bkt.clouddn.com/531e643df26bc6eebe4e372b0dcc7d93.png">
<meta property="og:image" content="http://oztni9daw.bkt.clouddn.com/7f3fb94468a83d4361ef97715bf04c9d.png">
<meta property="og:image" content="http://oztni9daw.bkt.clouddn.com/13709fa94840b9957e9f4f9d17be042a.png">
<meta property="og:updated_time" content="2017-12-08T01:10:57.791Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Jarvis OJ -- crypto题（中）">
<meta name="twitter:description" content="crypto题差一题AK--（中）">
<meta name="twitter:image" content="http://oztni9daw.bkt.clouddn.com/531e643df26bc6eebe4e372b0dcc7d93.png">






  <link rel="canonical" href="https://4Five.github.io/2017/12/01/Jarvis_crypto_2/"/>



<script type="text/javascript" id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>Jarvis OJ -- crypto题（中） | 4Five'S BLOG</title>
  









  <noscript>
  <style type="text/css">
    .use-motion .motion-element,
    .use-motion .brand,
    .use-motion .menu-item,
    .sidebar-inner,
    .use-motion .post-block,
    .use-motion .pagination,
    .use-motion .comments,
    .use-motion .post-header,
    .use-motion .post-body,
    .use-motion .collection-title { opacity: initial; }

    .use-motion .logo,
    .use-motion .site-title,
    .use-motion .site-subtitle {
      opacity: initial;
      top: initial;
    }

    .use-motion {
      .logo-line-before i { left: initial; }
      .logo-line-after i { right: initial; }
    }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-right page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">4Five'S BLOG</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">
    <a href="/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-home"></i> <br />首页</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-about">
    <a href="/about/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-user"></i> <br />关于</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">
    <a href="/tags/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />标签</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">
    <a href="/categories/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-th"></i> <br />分类</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">
    <a href="/archives/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />归档</a>
  </li>

      
      
    </ul>
  

  

  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
            

          
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://4Five.github.io/2017/12/01/Jarvis_crypto_2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="4Five">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/billy-christian-smoking-mob.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="4Five'S BLOG">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Jarvis OJ -- crypto题（中）
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2017-12-01 15:58:52" itemprop="dateCreated datePublished" datetime="2017-12-01T15:58:52+08:00">2017-12-01</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2017-12-08 09:10:57" itemprop="dateModified" datetime="2017-12-08T09:10:57+08:00">2017-12-08</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Jarvis-OJ/" itemprop="url" rel="index"><span itemprop="name">Jarvis OJ</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          
              <div class="post-description">crypto题差一题AK--（中）</div>
          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="Jarvis’s-encryption-system"><a href="#Jarvis’s-encryption-system" class="headerlink" title="Jarvis’s encryption system"></a>Jarvis’s encryption system</h1><blockquote>
<p>Let’s play with Jarvis’s new encryption box.</p>
<p>nc pwn.jarvisoj.com 9880</p>
<p>题目来源：基于BCTF2016 hyperRSA改编。</p>
<p>Hint1: 此题需要一定量的爆破。</p>
</blockquote>
<p>题目给了一个py，一个png</p>
<p>crypto500.py</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python</span><br><span class="line"></span><br><span class="line">from Crypto.PublicKey import RSA</span><br><span class="line">import gmpy2</span><br><span class="line"></span><br><span class="line">key = RSA.importKey(open(&apos;private.pem&apos;).read())</span><br><span class="line"></span><br><span class="line">N = 808637320166213096433765975908829772554859069394497436792703828416763985949910999652518305818627321094257781267795371106923808192073932662313603219525599014635435542122940843344921727149256852355110338886574805360544004118210641173633231100848831019159519744863314748281129830905559513810272933968408858616937223539622595750248885831720830102914499513408356858587797522763592193335162884129664298938995394243273615798207065590802899685489088903478734288977143851327400816886878238915788561611104380001569848016035186213716602462262685777960742683591155978590371074585063550419528377002596163321548052257322263024813745933243795081592986850478573362522245788630785664119935566422559659277401321793012274415007906726880710258434953224297253000176721652344571059040066987969691706315602374506498087282531643212970147526356421919309049062439117990930204486012562031589114880474346559407445496718773030816258262150397230280669274725009415653773469037623986165899557423095323109994543129373149980880777219450714265152054529287453826506032747047856303879606356141420416161004589629524370677871918513405209191951229311529443558187652701599377904802383252318582028816524498306240682160249309341335405511246150908708558397938689907425750101507</span><br><span class="line"></span><br><span class="line">p = key.p</span><br><span class="line">q = key.q</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def encrypt(m, e):</span><br><span class="line">    return pow(m, e, N)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def main():</span><br><span class="line">    print &apos;Welcome to Jarvis\&apos;s encryption system.Let\&apos;s init the cipher first:&apos;</span><br><span class="line">    print &quot;e:&quot;,</span><br><span class="line">    e = int(raw_input().strip())</span><br><span class="line">    d = gmpy2.invert(e, (p - 1) * (q - 1))</span><br><span class="line">    print &quot;d: %d&quot; % d</span><br><span class="line"></span><br><span class="line">    cnt = 0</span><br><span class="line">    while True:</span><br><span class="line">        cnt += 1</span><br><span class="line">        print &quot;m%d:&quot; % cnt,</span><br><span class="line">        m = int(raw_input().strip())</span><br><span class="line">        c = encrypt(m, e)</span><br><span class="line">        print &quot;c%d: %d&quot; % (cnt, c)</span><br><span class="line">        print &apos;&apos;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &apos;__main__&apos;:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>
<p>flag.png<br><img src="http://oztni9daw.bkt.clouddn.com/531e643df26bc6eebe4e372b0dcc7d93.png" alt="flag"></p>
<p>在线ocr提取一下图片中的数字：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Welcome to Jarvis&apos;s encryption system.Let&apos;s init the cipher first:</span><br><span class="line">m1: 89372489723987498237894327984372</span><br><span class="line">c1: 792279062886162218096642776664224514933347584486280723004734021586336212749049858600481963227286459323970478541843083793725468708921717787221937249530784012084036132167698694870670989692185525559265359595824727956010042190235432643115112280623082788133230708728369892499755238276075667536752879449115011933006031581738186877618805996280847737363426887886868682686959858371130406926178828888575004380515988821399247906070333132810952695798429265793849588130806947806841034544612000197604854503195512120025729616966658790540157838337703936086683817085220432748606686965902101050255048796382841321391071407100767404596588780879740560771450534303617347553555472893929700798373187625224545676303975128589469709553887522697982505366205159178754377849727155295773459020853899833570753142832536760229326028534739725856990225488803963836214548294423502322319111713836053680359093114158912017408230992904911531693795674356749450578360594750306010644345865018135713049088702085668117922755659876667178408188245170381487842104129405699987082399408416605832498886309106565903612880735897179022046135207448286905927468981921408174446350113407999312543013150441972687118445672308468055301677455644948365453703227341347327118261153884632046860369729</span><br><span class="line">m2: flag here</span><br><span class="line">c2: 738822002752800877524466308025949155169562722946933006009883884249589602039677687891359871510923927357766748131398443497541198900771818831638644263405425815579383553019562159083788644122365536627592737115316351290153544908592280731090451811311680698586032725090719266003369555867584457372823678746133588560994163232730766388456903527206840527304843529539480355012405496730615078972755415860013097394363116913629756292725693596880188792245847698225435105827398989245800248197290718407831242734331874121327502564673597694670795036098967372950089253263743880807024448724715652660602771818683520844873803372738417012436219777372987997036211306992938395670636075660990930360358970016244484405618827909229400111542660072678812089441010001235353317911131109787281238112284352067511452432985149442969693926797740772628154057474332702139775407456229918917403138849681496015981718513476254353617586634306067889050783266988506871489696817574207289110594169371818597141857443042841485880477066344316648550850088971005108756497748568090122624591451915965314486079436499049418137147522360690326710468200339550170216543240318289067712843687012174036874897324652429812609807952220427326987655148639613323665786093803557065570465270944069296977739085</span><br></pre></td></tr></table></figure>
<p>只知道一个不能分解的N，一段知道明文的密文，一段不知道明文的密文。理论上爆破出e，然后去服务端输入e就能得到d，于是我这样爆破</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">N = 808637320166213096433765975908829772554859069394497436792703828416763985949910999652518305818627321094257781267795371106923808192073932662313603219525599014635435542122940843344921727149256852355110338886574805360544004118210641173633231100848831019159519744863314748281129830905559513810272933968408858616937223539622595750248885831720830102914499513408356858587797522763592193335162884129664298938995394243273615798207065590802899685489088903478734288977143851327400816886878238915788561611104380001569848016035186213716602462262685777960742683591155978590371074585063550419528377002596163321548052257322263024813745933243795081592986850478573362522245788630785664119935566422559659277401321793012274415007906726880710258434953224297253000176721652344571059040066987969691706315602374506498087282531643212970147526356421919309049062439117990930204486012562031589114880474346559407445496718773030816258262150397230280669274725009415653773469037623986165899557423095323109994543129373149980880777219450714265152054529287453826506032747047856303879606356141420416161004589629524370677871918513405209191951229311529443558187652701599377904802383252318582028816524498306240682160249309341335405511246150908708558397938689907425750101507</span><br><span class="line">m1 = 89372489723987498237894327984372</span><br><span class="line">c1 = 792279062886162218096642776664224514933347584486280723004734021586336212749049858600481963227286459323970478541843083793725468708921717787221937249530784012084036132167698694870670989692185525559265359595824727956010042190235432643115112280623082788133230708728369892499755238276075667536752879449115011933006031581738186877618805996280847737363426887886868682686959858371130406926178828888575004380515988821399247906070333132810952695798429265793849588130806947806841034544612000197604854503195512120025729616966658790540157838337703936086683817085220432748606686965902101050255048796382841321391071407100767404596588780879740560771450534303617347553555472893929700798373187625224545676303975128589469709553887522697982505366205159178754377849727155295773459020853899833570753142832536760229326028534739725856990225488803963836214548294423502322319111713836053680359093114158912017408230992904911531693795674356749450578360594750306010644345865018135713049088702085668117922755659876667178408188245170381487842104129405699987082399408416605832498886309106565903612880735897179022046135207448286905927468981921408174446350113407999312543013150441972687118445672308468055301677455644948365453703227341347327118261153884632046860369729</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def encrypt(m, e):</span><br><span class="line">    return pow(m, e, N)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">for i in range(1000000):</span><br><span class="line">    c = encrypt(m1, i)</span><br><span class="line">    print i</span><br><span class="line">    if c == c1:</span><br><span class="line">        print &apos;e: %d&apos; % i</span><br><span class="line">        break</span><br></pre></td></tr></table></figure>
<p>如上，我爆破了1000000，还是没有爆破出来，说明e有点大，这样爆破可能明年就能做出这题了。换个思路，这里看到提示</p>
<blockquote>
<p>题目来源：基于BCTF2016 hyperRSA改编。</p>
</blockquote>
<p>然后谷歌<code>BCTF 2016 hyper RSA</code>找到这个</p>
<p><a href="https://grocid.net/2016/03/24/bctf-hyper-rsa-partial-write-up/" target="_blank" rel="noopener">https://grocid.net/2016/03/24/bctf-hyper-rsa-partial-write-up/</a></p>
<p>我理解的意思是先根据n，e，d解出p和q，然后再穷举攻击，所以还是得爆破，本来以为这样爆破的速度快一点，结果发现速度更慢了，excuse me，感觉这题改编的和原题一点都不像，不能按上面链接的那个思路，还是老老实实爆破e吧，这里记录一下得到p，q的过程，和本题无关</p>
<p>根据n，e，d解出p和q我们用rsatool来做</p>
<p>安装rsatool</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/ius/rsatool.git</span><br><span class="line">cd rsatool</span><br><span class="line">python setup.py install</span><br></pre></td></tr></table></figure>
<p>安装gmpy时可能会报错，不过在（上）中我们已经安装了gmpy2了，而且看到rsatool.py的开头，</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">try:</span><br><span class="line">    import gmpy</span><br><span class="line">except ImportError as e:</span><br><span class="line">    try:</span><br><span class="line">        import gmpy2 as gmpy</span><br><span class="line">    except ImportError:</span><br><span class="line">        raise e</span><br></pre></td></tr></table></figure>
<p>所以不需要再去安gmpy了</p>
<p>先去自己搞个e，d，如</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">➜  ~ nc pwn.jarvisoj.com 9880</span><br><span class="line">Welcome to Jarvis&apos;s encryption system.Let&apos;s init the cipher first:</span><br><span class="line">e: 12345</span><br><span class="line">d: 201356915527820093838590247869075959565300670661699888270617381008759213674364229480100548569174595791312144156922071347321489378893095909595141052800461026406587999715343876261019796618616084579960241534008177535707757688082584930558813479466124467630325127234494089608440105322291611620314216202421128504533416375925464506785344272718495887918928432905410205208496523691800923638095642431315354794529918339718355201594857806895756470894569403749990215011400583149488060843277740496325154993319956591723427525418563177072890722478371493029673795816866219375196491152246687240958301409961976998820470849656430663286940461573658530706920751204584928314511527848932364909480262481771973980401259537991290562234025866097602539853912980185823807829336228072050786680235009860665712273945365084597149021027979295475982762918274831787872437578386202106209918943005520433768199111496786661297419031437065511891561694954596320600362045032143402360451033935757012176534340874526429735666279970953464963828325846439119588268406895121820266798459368907873035613676994065206516383402542718175309215036737597352281817964369266908506553518026519971286354947917971368166585913520185398205139859199725823771675331562803357914714179340973647678752889</span><br></pre></td></tr></table></figure>
<p>新建一个get_pq.py</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">from rsatool import factor_modulus</span><br><span class="line"></span><br><span class="line">e = 12345</span><br><span class="line">d = 201356915527820093838590247869075959565300670661699888270617381008759213674364229480100548569174595791312144156922071347321489378893095909595141052800461026406587999715343876261019796618616084579960241534008177535707757688082584930558813479466124467630325127234494089608440105322291611620314216202421128504533416375925464506785344272718495887918928432905410205208496523691800923638095642431315354794529918339718355201594857806895756470894569403749990215011400583149488060843277740496325154993319956591723427525418563177072890722478371493029673795816866219375196491152246687240958301409961976998820470849656430663286940461573658530706920751204584928314511527848932364909480262481771973980401259537991290562234025866097602539853912980185823807829336228072050786680235009860665712273945365084597149021027979295475982762918274831787872437578386202106209918943005520433768199111496786661297419031437065511891561694954596320600362045032143402360451033935757012176534340874526429735666279970953464963828325846439119588268406895121820266798459368907873035613676994065206516383402542718175309215036737597352281817964369266908506553518026519971286354947917971368166585913520185398205139859199725823771675331562803357914714179340973647678752889</span><br><span class="line">n = 808637320166213096433765975908829772554859069394497436792703828416763985949910999652518305818627321094257781267795371106923808192073932662313603219525599014635435542122940843344921727149256852355110338886574805360544004118210641173633231100848831019159519744863314748281129830905559513810272933968408858616937223539622595750248885831720830102914499513408356858587797522763592193335162884129664298938995394243273615798207065590802899685489088903478734288977143851327400816886878238915788561611104380001569848016035186213716602462262685777960742683591155978590371074585063550419528377002596163321548052257322263024813745933243795081592986850478573362522245788630785664119935566422559659277401321793012274415007906726880710258434953224297253000176721652344571059040066987969691706315602374506498087282531643212970147526356421919309049062439117990930204486012562031589114880474346559407445496718773030816258262150397230280669274725009415653773469037623986165899557423095323109994543129373149980880777219450714265152054529287453826506032747047856303879606356141420416161004589629524370677871918513405209191951229311529443558187652701599377904802383252318582028816524498306240682160249309341335405511246150908708558397938689907425750101507</span><br><span class="line"></span><br><span class="line">print factor_modulus(n, d, e)</span><br></pre></td></tr></table></figure>
<p>执行得到p和q</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">➜  rsatool git:(master) ✗ python get_pq.py</span><br><span class="line">(27200154960954227235541819668009472012084286261734091722170154481644756866164527250830540275835506132703525181946061278474016037684976554417523086836831359548636853015984589908613534046005317727141826672590441878984810812783493735937537688532183221554822925253529608362391669124208763896128072575179396699623562847543761634607862389921729915536387801522541553962435180388095592872002991464363762976666060101937325707664414266166368945403841659913817298126829937148569179681290426604950786796380764431701519236947537978114396818142372228177619800336261973442683963482889536869167264816021933025822891275282558513928279L, 29729143871680528751740142119100596543134632399647397265497654715939443094184918167923383261983609500477990736235614419561382430137607621816853595552473874320617275905995651998776069698909071999346881132724516330101583472405523543921649250704165298312036068472395012578017885338290580565995781070427078565789924061087799055006909151787170102655896030290882335570861323074011189512021087001712931962221353481078772508888453639684477267704904921538633637138014338076307696912393557877527097168734733786901104596613726641973212386174566867834116990132542399691508959274527499752566503084136140055299008389146766847687733L)</span><br></pre></td></tr></table></figure>
<p>扯完废话，改进一下脚本然后放到服务器上跑，这次跑0到100000000，根据log的输出预算时间为21小时，先去看后面的题</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">import logging</span><br><span class="line"></span><br><span class="line">logging.basicConfig(level=logging.DEBUG,</span><br><span class="line">                    filename=&apos;rsa.log&apos;,</span><br><span class="line">                    filemode=&apos;a&apos;,</span><br><span class="line">                    format=&apos;%(asctime)s : %(message)s&apos;)</span><br><span class="line">N = 808637320166213096433765975908829772554859069394497436792703828416763985949910999652518305818627321094257781267795371106923808192073932662313603219525599014635435542122940843344921727149256852355110338886574805360544004118210641173633231100848831019159519744863314748281129830905559513810272933968408858616937223539622595750248885831720830102914499513408356858587797522763592193335162884129664298938995394243273615798207065590802899685489088903478734288977143851327400816886878238915788561611104380001569848016035186213716602462262685777960742683591155978590371074585063550419528377002596163321548052257322263024813745933243795081592986850478573362522245788630785664119935566422559659277401321793012274415007906726880710258434953224297253000176721652344571059040066987969691706315602374506498087282531643212970147526356421919309049062439117990930204486012562031589114880474346559407445496718773030816258262150397230280669274725009415653773469037623986165899557423095323109994543129373149980880777219450714265152054529287453826506032747047856303879606356141420416161004589629524370677871918513405209191951229311529443558187652701599377904802383252318582028816524498306240682160249309341335405511246150908708558397938689907425750101507</span><br><span class="line">m1 = 89372489723987498237894327984372</span><br><span class="line">c1 = 792279062886162218096642776664224514933347584486280723004734021586336212749049858600481963227286459323970478541843083793725468708921717787221937249530784012084036132167698694870670989692185525559265359595824727956010042190235432643115112280623082788133230708728369892499755238276075667536752879449115011933006031581738186877618805996280847737363426887886868682686959858371130406926178828888575004380515988821399247906070333132810952695798429265793849588130806947806841034544612000197604854503195512120025729616966658790540157838337703936086683817085220432748606686965902101050255048796382841321391071407100767404596588780879740560771450534303617347553555472893929700798373187625224545676303975128589469709553887522697982505366205159178754377849727155295773459020853899833570753142832536760229326028534739725856990225488803963836214548294423502322319111713836053680359093114158912017408230992904911531693795674356749450578360594750306010644345865018135713049088702085668117922755659876667178408188245170381487842104129405699987082399408416605832498886309106565903612880735897179022046135207448286905927468981921408174446350113407999312543013150441972687118445672308468055301677455644948365453703227341347327118261153884632046860369729</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def encrypt(m, e):</span><br><span class="line">    return pow(m, e, N)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">for i in xrange(100000000):</span><br><span class="line">    if i % 10000 == 0:</span><br><span class="line">        logging.debug(&apos;Brute Force e: %d&apos; % i)</span><br><span class="line">    c = encrypt(m1, i)</span><br><span class="line">    if c == c1:</span><br><span class="line">        logging.info(&apos;Find e: %d&apos; % i)</span><br><span class="line">        break</span><br></pre></td></tr></table></figure>
<p>吃了个晚饭，看了集<code>黑客军团</code>，登陆服务器一看，爆破出来了</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">root:~# head rsa.log</span><br><span class="line">2017-12-01 19:38:00,250 : Brute Force e: 0</span><br><span class="line">2017-12-01 19:38:04,344 : Brute Force e: 10000</span><br><span class="line">2017-12-01 19:38:09,663 : Brute Force e: 20000</span><br><span class="line">2017-12-01 19:38:15,528 : Brute Force e: 30000</span><br><span class="line">2017-12-01 19:38:21,614 : Brute Force e: 40000</span><br><span class="line">2017-12-01 19:38:27,950 : Brute Force e: 50000</span><br><span class="line">2017-12-01 19:38:34,411 : Brute Force e: 60000</span><br><span class="line">2017-12-01 19:38:41,028 : Brute Force e: 70000</span><br><span class="line">2017-12-01 19:38:47,804 : Brute Force e: 80000</span><br><span class="line">2017-12-01 19:38:54,710 : Brute Force e: 90000</span><br><span class="line">root:~# tail rsa.log</span><br><span class="line">2017-12-01 21:47:08,037 : Brute Force e: 7760000</span><br><span class="line">2017-12-01 21:47:18,886 : Brute Force e: 7770000</span><br><span class="line">2017-12-01 21:47:29,725 : Brute Force e: 7780000</span><br><span class="line">2017-12-01 21:47:40,583 : Brute Force e: 7790000</span><br><span class="line">2017-12-01 21:47:51,453 : Brute Force e: 7800000</span><br><span class="line">2017-12-01 21:48:02,286 : Brute Force e: 7810000</span><br><span class="line">2017-12-01 21:48:13,143 : Brute Force e: 7820000</span><br><span class="line">2017-12-01 21:48:24,017 : Brute Force e: 7830000</span><br><span class="line">2017-12-01 21:48:34,867 : Brute Force e: 7840000</span><br><span class="line">2017-12-01 21:48:41,113 : Find e: 7845741</span><br></pre></td></tr></table></figure>
<p>可以看到，爆破用时2h 10min 41s，出题人一点都不友好</p>
<p>然后可以通过上面得到的<code>p</code>和<code>q</code>来得到<code>e=7845741</code>时的<code>d</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">import libnum</span><br><span class="line">p = 27200154960954227235541819668009472012084286261734091722170154481644756866164527250830540275835506132703525181946061278474016037684976554417523086836831359548636853015984589908613534046005317727141826672590441878984810812783493735937537688532183221554822925253529608362391669124208763896128072575179396699623562847543761634607862389921729915536387801522541553962435180388095592872002991464363762976666060101937325707664414266166368945403841659913817298126829937148569179681290426604950786796380764431701519236947537978114396818142372228177619800336261973442683963482889536869167264816021933025822891275282558513928279</span><br><span class="line">q = 29729143871680528751740142119100596543134632399647397265497654715939443094184918167923383261983609500477990736235614419561382430137607621816853595552473874320617275905995651998776069698909071999346881132724516330101583472405523543921649250704165298312036068472395012578017885338290580565995781070427078565789924061087799055006909151787170102655896030290882335570861323074011189512021087001712931962221353481078772508888453639684477267704904921538633637138014338076307696912393557877527097168734733786901104596613726641973212386174566867834116990132542399691508959274527499752566503084136140055299008389146766847687733</span><br><span class="line">d = libnum.invmod(7845741, (p - 1) * (q - 1))</span><br><span class="line"># d = 624460328909915360701402168639641282028094468418961878947574807290638891758678991143435088653980701535371225162050430031333639072505365342535152293096454464491608234713910040741806054032872119204341656042243036836513731486079394171780995659012791615808025872985542653518800484827924355387767430294123689221121329057758535673622344148467540232245253256875196052350040448617224502051601181938246394036842235391465615724331125440683500889291172253639404968619326290436776700446299000007994603663440301337649478949521483497552296109838827309290662620012954396232530653067994746179325738761837228276717554780296018709380622306541045859622715377902354561164951333797443088787938481179135106105790091663516291819506679417163921126064227724274720567814644923715786512409941352289194976639518315198223889636540907899742620702027181209723760906029440110133038012652837512150214031930229627563605747245442722777826347211476418833664939434587222857079580932195626606642019627685477852118740507133047312988551945249158637120933025247874896831420739652406553559282198158772718455703088272187706565621125165787151495212884395636011063049499722644316616892917352706474956487897928799493388647214180485284836266930315584778253034297866155428036121429</span><br></pre></td></tr></table></figure>
<p>我们可以去服务端验证一下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">➜  ~ nc pwn.jarvisoj.com 9880</span><br><span class="line">Welcome to Jarvis&apos;s encryption system.Let&apos;s init the cipher first:</span><br><span class="line">e: 7845741</span><br><span class="line">d: 624460328909915360701402168639641282028094468418961878947574807290638891758678991143435088653980701535371225162050430031333639072505365342535152293096454464491608234713910040741806054032872119204341656042243036836513731486079394171780995659012791615808025872985542653518800484827924355387767430294123689221121329057758535673622344148467540232245253256875196052350040448617224502051601181938246394036842235391465615724331125440683500889291172253639404968619326290436776700446299000007994603663440301337649478949521483497552296109838827309290662620012954396232530653067994746179325738761837228276717554780296018709380622306541045859622715377902354561164951333797443088787938481179135106105790091663516291819506679417163921126064227724274720567814644923715786512409941352289194976639518315198223889636540907899742620702027181209723760906029440110133038012652837512150214031930229627563605747245442722777826347211476418833664939434587222857079580932195626606642019627685477852118740507133047312988551945249158637120933025247874896831420739652406553559282198158772718455703088272187706565621125165787151495212884395636011063049499722644316616892917352706474956487897928799493388647214180485284836266930315584778253034297866155428036121429</span><br></pre></td></tr></table></figure>
<p>最后一步，用d解密</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">c2 = 738822002752800877524466308025949155169562722946933006009883884249589602039677687891359871510923927357766748131398443497541198900771818831638644263405425815579383553019562159083788644122365536627592737115316351290153544908592280731090451811311680698586032725090719266003369555867584457372823678746133588560994163232730766388456903527206840527304843529539480355012405496730615078972755415860013097394363116913629756292725693596880188792245847698225435105827398989245800248197290718407831242734331874121327502564673597694670795036098967372950089253263743880807024448724715652660602771818683520844873803372738417012436219777372987997036211306992938395670636075660990930360358970016244484405618827909229400111542660072678812089441010001235353317911131109787281238112284352067511452432985149442969693926797740772628154057474332702139775407456229918917403138849681496015981718513476254353617586634306067889050783266988506871489696817574207289110594169371818597141857443042841485880477066344316648550850088971005108756497748568090122624591451915965314486079436499049418137147522360690326710468200339550170216543240318289067712843687012174036874897324652429812609807952220427326987655148639613323665786093803557065570465270944069296977739085</span><br><span class="line">m2 = pow(c2, d, N)</span><br><span class="line">print libnum.n2s(m2)</span><br><span class="line"># WUSTCTF&#123;U_r_real33y_m4st3r_0f_math&#125;</span><br></pre></td></tr></table></figure>
<h1 id="影之密码"><a href="#影之密码" class="headerlink" title="影之密码"></a>影之密码</h1><blockquote>
<p>请分析下列密文进行解密 8842101220480224404014224202480122 得到flag，flag为8位大写字母</p>
<p>题目来源：CFF2016</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">import string</span><br><span class="line">flag = &apos;&apos;</span><br><span class="line">for i in &apos;8842101220480224404014224202480122&apos;.split(&apos;0&apos;):</span><br><span class="line">    n = 0</span><br><span class="line">    for j in i:</span><br><span class="line">        n += int(j)</span><br><span class="line">    flag += string.uppercase[n - 1]</span><br><span class="line">print flag</span><br><span class="line"># WELLDONE</span><br></pre></td></tr></table></figure>
<h1 id="好多盐"><a href="#好多盐" class="headerlink" title="好多盐"></a>好多盐</h1><blockquote>
<p>某遗留系统采用固定格式+6-10位数字类型密码，今天他们发生了数据泄露事件，已知固定格式为{FLAG:}，做为一名黑客，你要开始干活了。字符串长度为10位</p>
<p>题目来源：CFF2016</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line">import hashlib</span><br><span class="line">import logging</span><br><span class="line"></span><br><span class="line">logging.basicConfig(level=logging.DEBUG,</span><br><span class="line">                    format=&apos;%(asctime)s : %(message)s&apos;)</span><br><span class="line">password = &apos;&apos;&apos;f09ebdb2bb9f5eb4fbd12aad96e1e929 p5Zg6LtD</span><br><span class="line">6cea25448314ddb70d98708553fc0928 ZwbWnG0j</span><br><span class="line">2629906b029983a7c524114c2dd9cc36 1JE25XOn</span><br><span class="line">2e854eb55586dc58e6758cfed62dd865 ICKTxe5j</span><br><span class="line">7b073411ee21fcaf177972c1a644f403 0wdRCo1W</span><br><span class="line">6795d1be7c63f30935273d9eb32c73e3 EuMN5GaH</span><br><span class="line">d10f5340214309e3cfc00bbc7a2fa718 aOrND9AB</span><br><span class="line">8e0dc02301debcc965ee04c7f5b5188b uQg6JMcx</span><br><span class="line">4fec71840818d02f0603440466a892c9 XY5QnHmU</span><br><span class="line">ee8f46142f3b5d973a01079f7b47e81c zMVNlHOr</span><br><span class="line">e4d9e1e85f3880aedb7264054acd1896 TqRhn1Yp</span><br><span class="line">0fd046d8ecddefc66203f6539cac486b AR5lI2He</span><br><span class="line">f6326f02adaa31a66ed06ceab2948d01 Aax2fIPl</span><br><span class="line">720ba10d446a337d79f1da8926835a49 ZAOYDPR2</span><br><span class="line">06af8bcc454229fe5ca09567a9071e62 hvcECKYs</span><br><span class="line">79f58ca7a81ae2775c2c2b73beff8644 TgFacoR3</span><br><span class="line">46aaa5a7fef5e250a2448a8d1257e9cf GLYu0NO4</span><br><span class="line">2149ac87790dd0fe1b43f40d527e425a 5Xk2O1sG</span><br><span class="line">d15a36d8be574ac8fe64689c728c268e aZikhUEy</span><br><span class="line">ff7bced91bd9067834e3ad14cc1464cd E7UROqXn</span><br><span class="line">8cc0437187caf10e5eda345cb6296252 XPin3mVB</span><br><span class="line">5cfcdca4a9cb2985a0b688406617689e nsGqoafv</span><br><span class="line">5a7dfa8bc7b5dfbb914c0a78ab2760c6 YC1qZUFR</span><br><span class="line">8061d8f222167fcc66569f6261ddd3cc wNgQi615</span><br><span class="line">3d8a02528c949df7405f0b48afe4a626 CO2NMusb</span><br><span class="line">70651acbc8bd027529bbcccdbf3b0f14 CAXVjFMd</span><br><span class="line">a9dbe70e83596f2d9210970236bdd535 TL6sjEuK</span><br><span class="line">9ed6ef5780f705ade6845b9ef349eb8f tJ90ibsz</span><br><span class="line">4b46fac0c41b0c6244523612a6c7ac4a VTjOSNmw</span><br><span class="line">8141e6ecb4f803426d1db8fbeb5686ef lh75cdNC</span><br><span class="line">df803949fd13f5f7d7dd8457a673104b V39sEvYX</span><br><span class="line">19052cc5ef69f90094753c2b3bbcd41d YwoGExpg</span><br><span class="line">cf8591bdccfaa0cdca652f1d31dbd70f pJCLui49</span><br><span class="line">66e10e3d4a788c335282f42b92c760a1 NQCZoIhj</span><br><span class="line">94c3ae5bcc04c38053106916f9b99bda vOktelLQ</span><br><span class="line">e67e88646758e465697c15b1ef164a8d x0hwJGHj</span><br><span class="line">84d3d828e1a0c14b5b095bedc23269fb 2HVWe9fM</span><br><span class="line">264a9e831c3401c38021ba3844479c3f Cx4og6IW</span><br><span class="line">ed0343dec184d9d2c30a9b9c1c308356 g2rqmPkT</span><br><span class="line">ad5ba8dc801c37037350578630783d80 pFK2JDT5</span><br><span class="line">3f588bedb704da9448e68fe81e42bca6 4ANDOiau</span><br><span class="line">970c9cf3cad3dfa7926f53ccaae89421 R6ML7Qy8</span><br><span class="line">e0a097b7cceaa7a8949fe039884e4a2d dul2ynqL</span><br><span class="line">7df505218102c64b1fe4fa5981ddb6fa jPeoyS57</span><br><span class="line">fd4f6043da1f7d5dca993c946ef6cd7c 6p9CwGaY</span><br><span class="line">5fe6d99b9a2824949279187c246c9c30 OGQ2J57y</span><br><span class="line">135b150ad513a961089bb1c05085a3d9 h0dw1Fro</span><br><span class="line">ad6af4fb623b3c51181a371911667fed HbQT4dRz</span><br><span class="line">c9fa4b0db317d88e2b10060225e92494 ebVnpMzS</span><br><span class="line">d0deab17d115bd6fdce8592bb3667643 bL5zwgvX</span><br><span class="line">006f0cb3a422716692f143f28eb0d187 NHXg1Fof</span><br><span class="line">ddc125de34da1a6ec0cbe401f147bc8f GDai9Y0n</span><br><span class="line">be5052053c5a806e8f56ed64e0d67821 40alyH3w</span><br><span class="line">aaf18ac446b8c385c4112c10ae87e7dc ZJQzuIL0</span><br><span class="line">a2db20a4b7386dc2d8c30bf9a05ceef7 QnpOlPWH</span><br><span class="line">8a4fbc32a3251bb51072d51969ba5d33 rtcbipeq</span><br><span class="line">5e35d2c9675ed811880cea01f268e00f i1Hbne6h</span><br><span class="line">9da23007699e832f4e9344057c5e0bd3 EtbGpMSW</span><br><span class="line">f09233683d05171420f963fc92764e84 fxHoinEe</span><br><span class="line">4feabf309c5872f3cca7295b3577f2a8 KymkJXqA</span><br><span class="line">9b94da2fa9402a3fdb4ff15b9f3ba4d2 G3Tdr1Pg</span><br><span class="line">b3cd8d6b53702d733ba515dec1d770c5 Y71LJWZz</span><br><span class="line">6a5b3b2526bb7e94209c487585034534 rIwb4oxt</span><br><span class="line">e9728ef776144c25ba0155a0faab2526 e1sOXSb8</span><br><span class="line">d41a5e7a98e28d76dbd183df7e3bcb49 36bedvia</span><br><span class="line">81d5ebfea6aff129cf515d4e0e5f8360 dDG4qTjW&apos;&apos;&apos;</span><br><span class="line"></span><br><span class="line">password = password.split(&apos;\n&apos;)</span><br><span class="line">for i in password:</span><br><span class="line">    pass_md5 = i.split(&apos; &apos;)[0]</span><br><span class="line">    salt = i.split(&apos; &apos;)[1]</span><br><span class="line">    logging.debug(&apos;start: &apos; + pass_md5 + &apos; &apos; + salt)</span><br><span class="line">    for j in xrange(10000000000):</span><br><span class="line">        if j % 100000000 == 0:</span><br><span class="line">            logging.debug(&apos;exploit num: &apos; + str(j))</span><br><span class="line">        md5 = hashlib.md5()</span><br><span class="line">        md5.update(&apos;&#123;FLAG:&apos; + str(j).zfill(10) + &apos;&#125;&apos; + salt)</span><br><span class="line">        if md5.hexdigest() == pass_md5:</span><br><span class="line">            logging.info(&apos;sucess find flag:&apos; + j)</span><br><span class="line">            break</span><br></pre></td></tr></table></figure>
<blockquote>
<p>flag:1234567890</p>
</blockquote>
<h1 id="superexpress"><a href="#superexpress" class="headerlink" title="superexpress"></a>superexpress</h1><blockquote>
<p>题目来源：TWCTF2016</p>
</blockquote>
<p>下载解压，两个文件</p>
<p>encrypted</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">805eed80cbbccb94c36413275780ec94a857dfec8da8ca94a8c313a8ccf9</span><br></pre></td></tr></table></figure>
<p>problem.py</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">key = &apos;****CENSORED***************&apos;</span><br><span class="line">flag = &apos;TWCTF&#123;*******CENSORED********&#125;&apos;</span><br><span class="line"></span><br><span class="line">if len(key) % 2 == 1:</span><br><span class="line">    print(&quot;Key Length Error&quot;)</span><br><span class="line">    sys.exit(1)</span><br><span class="line"></span><br><span class="line">n = len(key) / 2</span><br><span class="line">encrypted = &apos;&apos;</span><br><span class="line">for c in flag:</span><br><span class="line">    c = ord(c)</span><br><span class="line">    for a, b in zip(key[0:n], key[n:2*n]):</span><br><span class="line">        c = (ord(a) * c + ord(b)) % 251</span><br><span class="line">    encrypted += &apos;%02x&apos; % c</span><br><span class="line"></span><br><span class="line">print encrypted</span><br></pre></td></tr></table></figure>
<p>设<code>key</code>为<code>&#39;a1a2a3b1b2b3&#39;</code>，zip后得到一个列表包含三个元组<code>[(a1,b1),(a2,b2),(a3,b3)]</code>，按照脚本里的加密方式，可以推出</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a3*(a2*(a1*c+b1)+b2)+b3 = a3*a2*a1*c+b1*a2*a3+b2*a3+b3</span><br></pre></td></tr></table></figure>
<p>于是</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">import string</span><br><span class="line">q = &quot;805eed80cbbccb94c36413275780ec94a857dfec8da8ca94a8c313a8ccf9&quot;</span><br><span class="line">Q = []</span><br><span class="line">for i in range(0, len(q), 2):</span><br><span class="line">    Q += [int(q[i:i + 2], 16)]</span><br><span class="line"></span><br><span class="line">for a in range(251):</span><br><span class="line">    for b in range(251):</span><br><span class="line">        if (ord(&quot;T&quot;) * a + b) % 251 == Q[0] and (ord(&quot;W&quot;) * a + b) % 251 == Q[1]:</span><br><span class="line">            A = &quot;&quot;</span><br><span class="line">            for q in Q:</span><br><span class="line">                for i in string.printable:</span><br><span class="line">                    if (ord(i) * a + b) % 251 == q:</span><br><span class="line">                        A += chr(ord(i))</span><br><span class="line">            print A</span><br><span class="line"># TWCTF&#123;Faster_Than_Shinkansen!&#125;</span><br></pre></td></tr></table></figure>
<h1 id="vigenere"><a href="#vigenere" class="headerlink" title="vigenere"></a>vigenere</h1><blockquote>
<p>题目来源：TWCTF2016</p>
</blockquote>
<p>解压，有三个文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">➜  Downloads cd vigenere_300</span><br><span class="line">➜  vigenere_300 ls</span><br><span class="line">README        cipher.py     encrypted.txt</span><br><span class="line">➜  vigenere_300 cat README</span><br><span class="line">$ file plain.txt</span><br><span class="line">plain.txt: ASCII text</span><br><span class="line">$ python cipher.py encrypt key plain.txt &gt; encrypted.txt</span><br><span class="line"></span><br><span class="line">➜  vigenere_300 cat encrypted.txt</span><br><span class="line">a7TFeCShtf94+t5quSA5ZBn4+3tqLTl0EvoMsNxeeCm50Xoet+1fvy821r6Fe4fpeAw1ZB+as3Tphe8xZXQ/s3tbJy8BDzX4vN5svYqIZ96rt35dKuz0DfCPf4nfKe300fM9utiauTe5tgs5utLpLTh0FzYx0O1sJYKgJvul0OfiuTl00BCks+aaJZm8Kwb4u+LtLCqbZ96lv3bieCahtegx+7nzqyO6YCb4b9LovCELZ9Pe0L5rLSaBDzXaftxseAw1JzCF0MGjeCacKb69u9TlgCudZT6Os3ojhcWxD914vNHfeCuaJvH4s4aarBKlGdsT8G4UKZhfJB+y0LbjqCOnZT6baF1WiZeNtfsNtuoo+c==</span><br><span class="line">➜  vigenere_300 cat cipher.py</span><br><span class="line"># Python 3 Source Code</span><br><span class="line">from base64 import b64encode, b64decode</span><br><span class="line">import sys</span><br><span class="line">import os</span><br><span class="line">import random</span><br><span class="line"></span><br><span class="line">chars = &apos;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/&apos;</span><br><span class="line"></span><br><span class="line">def shift(char, key, rev = False):</span><br><span class="line">    if not char in chars:</span><br><span class="line">        return char</span><br><span class="line">    if rev:</span><br><span class="line">        return chars[(chars.index(char) - chars.index(key)) % len(chars)]</span><br><span class="line">    else:</span><br><span class="line">        return chars[(chars.index(char) + chars.index(key)) % len(chars)]</span><br><span class="line"></span><br><span class="line">def encrypt(message, key):</span><br><span class="line">    encrypted = b64encode(message.encode(&apos;ascii&apos;)).decode(&apos;ascii&apos;)</span><br><span class="line">    return &apos;&apos;.join([shift(encrypted[i], key[i % len(key)]) for i in range(len(encrypted))])</span><br><span class="line"></span><br><span class="line">def decrypt(encrypted, key):</span><br><span class="line">    encrypted = &apos;&apos;.join([shift(encrypted[i], key[i % len(key)], True) for i in range(len(encrypted))])</span><br><span class="line">    return b64decode(encrypted.encode(&apos;ascii&apos;)).decode(&apos;ascii&apos;)</span><br><span class="line"></span><br><span class="line">def generate_random_key(length = 5):</span><br><span class="line">    return &apos;&apos;.join(map(lambda a : chars[a % len(chars)], os.urandom(length)))</span><br><span class="line"></span><br><span class="line">if len(sys.argv) == 4 and sys.argv[1] == &apos;encrypt&apos;:</span><br><span class="line">    f = open(sys.argv[3])</span><br><span class="line">    plain = f.read()</span><br><span class="line">    f.close()</span><br><span class="line"></span><br><span class="line">    key = generate_random_key(random.randint(5,14))</span><br><span class="line"></span><br><span class="line">    print(encrypt(plain, key))</span><br><span class="line"></span><br><span class="line">    f = open(sys.argv[2], &apos;w&apos;)</span><br><span class="line">    f.write(key)</span><br><span class="line">    f.close()</span><br><span class="line"></span><br><span class="line">elif len(sys.argv) == 4 and sys.argv[1] == &apos;decrypt&apos;:</span><br><span class="line">    f = open(sys.argv[3])</span><br><span class="line">    encrypted = f.read()</span><br><span class="line">    f.close()</span><br><span class="line"></span><br><span class="line">    f = open(sys.argv[2])</span><br><span class="line">    key = f.read()</span><br><span class="line">    f.close()</span><br><span class="line"></span><br><span class="line">    print(decrypt(encrypted, key), end = &apos;&apos;)</span><br><span class="line"></span><br><span class="line">else:</span><br><span class="line">    print(&quot;Usage: python %s encrypt|decrypt (key-file) (input-file)&quot; % sys.argv[0])</span><br></pre></td></tr></table></figure>
<p>解密脚本<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br></pre></td><td class="code"><pre><span class="line"># Python 3 Source Code</span><br><span class="line">from base64 import b64encode, b64decode</span><br><span class="line">import os</span><br><span class="line">from math import sqrt</span><br><span class="line"></span><br><span class="line">candi_count = 0</span><br><span class="line">chars = &apos;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/&apos;</span><br><span class="line">encrypted = &quot;a7TFeCShtf94+t5quSA5ZBn4+3tqLTl0EvoMsNxeeCm50Xoet+1fvy821r6Fe4fpeAw1ZB+as3Tphe8xZXQ/s3tbJy8BDzX4vN5svYqIZ96rt35dKuz0DfCPf4nfKe300fM9utiauTe5tgs5utLpLTh0FzYx0O1sJYKgJvul0OfiuTl00BCks+aaJZm8Kwb4u+LtLCqbZ96lv3bieCahtegx+7nzqyO6YCb4b9LovCELZ9Pe0L5rLSaBDzXaftxseAw1JzCF0MGjeCacKb69u9TlgCudZT6Os3ojhcWxD914vNHfeCuaJvH4s4aarBKlGdsT8G4UKZhfJB+y0LbjqCOnZT6baF1WiZeNtfsNtuoo+c==&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def shift(char, key, rev=False):</span><br><span class="line">    if char not in chars:</span><br><span class="line">        return char</span><br><span class="line">    if rev:</span><br><span class="line">        return chars[(chars.index(char) - chars.index(key)) % len(chars)]</span><br><span class="line">    else:</span><br><span class="line">        print((chars.index(char) + chars.index(key)) % len(chars))</span><br><span class="line">        return chars[(chars.index(char) + chars.index(key)) % len(chars)]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def encrypt(message, key):</span><br><span class="line">    encrypted = b64encode(message.encode(&apos;ascii&apos;)).decode(&apos;ascii&apos;)</span><br><span class="line">    return &apos;&apos;.join([shift(encrypted[i], key[i % len(key)]) for i in range(len(encrypted))])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def original_decrypt(encrypted, key):</span><br><span class="line">    encrypted = &apos;&apos;.join([shift(encrypted[i], key[i % len(key)], True)</span><br><span class="line">                         for i in range(len(encrypted))])</span><br><span class="line">    return b64decode(encrypted.encode(&apos;ascii&apos;)).decode(&apos;ascii&apos;)</span><br><span class="line"></span><br><span class="line"># not using encode or decode ascii</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def decrypt(encrypted, key):</span><br><span class="line">    encrypted = &apos;&apos;.join([shift(encrypted[i], key[i % len(key)], True)</span><br><span class="line">                         for i in range(len(encrypted))])</span><br><span class="line">    return b64decode(encrypted)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def generate_random_key(length=5):</span><br><span class="line">    return &apos;&apos;.join(map(lambda a: chars[a % len(chars)], os.urandom(length)))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def Kasiski_exam(encrypted):</span><br><span class="line">    strlist = []</span><br><span class="line">    count = 0</span><br><span class="line">    indexlist = []</span><br><span class="line">    for i in range(len(encrypted)):</span><br><span class="line">        for j in range(i, len(encrypted)):</span><br><span class="line">            if j - i &lt; 3:</span><br><span class="line">                continue</span><br><span class="line">            start = i</span><br><span class="line">            search_str = encrypted[i:j]</span><br><span class="line">            while True:</span><br><span class="line">                detect = encrypted[start:].find(search_str)</span><br><span class="line">                if detect == -1:</span><br><span class="line">                    break</span><br><span class="line">                else:</span><br><span class="line">                    count += 1</span><br><span class="line">                    if count == 2:</span><br><span class="line">                        strlist.append(search_str)</span><br><span class="line">                        indexlist.append(detect + j - i)</span><br><span class="line">                    start += detect + (j - i)</span><br><span class="line">            if count == 0:</span><br><span class="line">                break</span><br><span class="line">            count = 0</span><br><span class="line">    print(indexlist)</span><br><span class="line">    print(strlist)</span><br><span class="line">    anslist = my_factor(indexlist)</span><br><span class="line">    return anslist</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def my_factor(numlist):</span><br><span class="line">    factor_list = []</span><br><span class="line">    for x in range(2, int(sqrt(numlist[0])) + 1):</span><br><span class="line">        if numlist[0] % x == 0 and x &gt;= 5 and x &lt;= 14:</span><br><span class="line">            factor_list.append(x)</span><br><span class="line">    for i in range(1, len(numlist)):</span><br><span class="line">        anslist = list(factor_list)</span><br><span class="line">        num = numlist[i]</span><br><span class="line">        for x in factor_list:</span><br><span class="line">            if num % x != 0:</span><br><span class="line">                anslist.remove(x)</span><br><span class="line">    return anslist</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def is_ascii(string):</span><br><span class="line">    if string:</span><br><span class="line">        for char in string:</span><br><span class="line">            if char &gt; 126:</span><br><span class="line">                return False</span><br><span class="line">            if char &lt; 32 and not char == 10:</span><br><span class="line">                return False</span><br><span class="line">    return True</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def split_str_and_isascii(plain, num, block):</span><br><span class="line">    start = 3 * block</span><br><span class="line">    for i in range(start, len(plain), 9):</span><br><span class="line">        if not is_ascii(plain[i:i + num]):</span><br><span class="line">            return False</span><br><span class="line">    return True</span><br><span class="line"></span><br><span class="line"># if key_len == 12</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def brute_key(encrypted, key_len):</span><br><span class="line">    global candi_count</span><br><span class="line">    candi_key_list = [[], [], []]</span><br><span class="line">    for block in range(int(key_len / 4)):</span><br><span class="line">        for a in chars:</span><br><span class="line">            for b in chars:</span><br><span class="line">                if not split_str_and_isascii(decrypt(encrypted, a + b + &quot;aa&quot;), 1, block):</span><br><span class="line">                    continue</span><br><span class="line">                for c in chars:</span><br><span class="line">                    if not split_str_and_isascii(decrypt(encrypted, a + b + c + &quot;a&quot;), 2, block):</span><br><span class="line">                        continue</span><br><span class="line">                    for d in chars:</span><br><span class="line">                        if split_str_and_isascii(decrypt(encrypted, a + b + c + d), 3, block):</span><br><span class="line">                            candi_key_list[block].append(a + b + c + d)</span><br><span class="line">                            candi_count += 1</span><br><span class="line">    return candi_key_list</span><br><span class="line"></span><br><span class="line"># if key_len == 6</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def brute_key_6(encrypted, key_len):</span><br><span class="line">    global candi_count</span><br><span class="line">    candi_key_list = []</span><br><span class="line">    for block in range(int(key_len / 4)):</span><br><span class="line">        for a in chars:</span><br><span class="line">            for b in chars:</span><br><span class="line">                if not split_str_and_isascii(decrypt(encrypted, a + b + &quot;aa&quot;), 1, block):</span><br><span class="line">                    continue</span><br><span class="line">                for c in chars:</span><br><span class="line">                    if not split_str_and_isascii(decrypt(encrypted, a + b + c + &quot;a&quot;), 2, block):</span><br><span class="line">                        continue</span><br><span class="line">                    for d in chars:</span><br><span class="line">                        if split_str_and_isascii(decrypt(encrypted, a + b + c + d), 3, block):</span><br><span class="line">                            candi_key_list.append(a + b + c + d)</span><br><span class="line">                            candi_count += 1</span><br><span class="line">    return candi_key_list</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def main():</span><br><span class="line">    # ==== kasiski examination ====</span><br><span class="line">    factor_list = Kasiski_exam(encrypted)  # [6,12]</span><br><span class="line">    key_len = factor_list[1]</span><br><span class="line">    # ==== brute force attack to base64 ====</span><br><span class="line">    print(&quot;Start brute force...&quot;)</span><br><span class="line">    candi_key1, candi_key2, candi_key3 = brute_key(encrypted, key_len)</span><br><span class="line">    print(candi_key1)</span><br><span class="line">    print(candi_key2)</span><br><span class="line">    print(candi_key3)</span><br><span class="line"></span><br><span class="line">    # ==== key candidate ====</span><br><span class="line">    keylist = []</span><br><span class="line">    for key1 in candi_key1:</span><br><span class="line">        for key2 in candi_key2:</span><br><span class="line">            for key3 in candi_key3:</span><br><span class="line">                keylist.append(key1 + key2 + key3)</span><br><span class="line">    print(candi_count)</span><br><span class="line">    print(keylist)</span><br><span class="line"></span><br><span class="line">    # if &quot;TWCTF&#123;&quot; in decrypted, It is highly possible that the key is correct.</span><br><span class="line">    for key in keylist:</span><br><span class="line">        dec = decrypt(encrypted, key)</span><br><span class="line">        check = b&quot;TWCTF&#123;&quot;</span><br><span class="line">        if check in dec:</span><br><span class="line">            print(&quot;--------- key candidate : decrypted ---------------&quot;)</span><br><span class="line">            print(key, &quot;:&quot;, dec)</span><br><span class="line">            print()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &apos;__main__&apos;:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure></p>
<p>具体操作过程参见：<a href="http://73spica.tech/blog/tw_mma_ctf_2016_vigenere-cipher/" target="_blank" rel="noopener">http://73spica.tech/blog/tw_mma_ctf_2016_vigenere-cipher/</a></p>
<p>运行结果</p>
<p><img src="http://oztni9daw.bkt.clouddn.com/7f3fb94468a83d4361ef97715bf04c9d.png" alt=""></p>
<blockquote>
<p>TWCTF{C14ss1caL CiPhEr iS v3ry fun}</p>
</blockquote>
<h1 id="DSA"><a href="#DSA" class="headerlink" title="DSA"></a>DSA</h1><blockquote>
<p>DSA是基于整数有限域离散对数难题的，其安全性与RSA相比差不多。DSA的一个重要特点是两个素数公开，这样，当使用别人的p和q时，即使不知道私钥x，你也能确认它们是否是随机产生的，还是作了手脚。</p>
<p>可以使用openssl方便地进行dsa签名和验证。</p>
<p>签名与验证：</p>
<p>openssl dgst -sha1 -sign dsa_private.pem -out sign.bin message.txt</p>
<p>openssl sha1 -verify dsa_public.pem -signature sign.bin message.txt</p>
<p>本题的攻击方法曾被用于PS3的破解，答案格式：CTF{x}(x为私钥，请提交十进制格式)</p>
</blockquote>
<p>目录结构为</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">➜  dsa tree</span><br><span class="line">.</span><br><span class="line">├── dsa_public.pem</span><br><span class="line">├── packet1</span><br><span class="line">│   ├── message1</span><br><span class="line">│   └── sign1.bin</span><br><span class="line">├── packet2</span><br><span class="line">│   ├── message2</span><br><span class="line">│   └── sign2.bin</span><br><span class="line">├── packet3</span><br><span class="line">│   ├── message3</span><br><span class="line">│   └── sign3.bin</span><br><span class="line">└── packet4</span><br><span class="line">    ├── message4</span><br><span class="line">    └── sign4.bin</span><br><span class="line"></span><br><span class="line">4 directories, 9 files</span><br></pre></td></tr></table></figure>
<p>先用题目给的验证命令看一下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">➜  dsa openssl sha1 -verify dsa_public.pem -signature packet1/sign1.bin packet1/message1</span><br><span class="line">Verified OK</span><br><span class="line">➜  dsa openssl sha1 -verify dsa_public.pem -signature packet2/sign2.bin packet2/message2</span><br><span class="line">Verified OK</span><br><span class="line">➜  dsa openssl sha1 -verify dsa_public.pem -signature packet3/sign3.bin packet3/message3</span><br><span class="line">Verified OK</span><br><span class="line">➜  dsa openssl sha1 -verify dsa_public.pem -signature packet4/sign4.bin packet4/message4</span><br><span class="line">Verified OK</span><br></pre></td></tr></table></figure>
<p>读一下公钥</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">➜  dsa openssl dsa -in dsa_public.pem -text -noout  -pubin</span><br><span class="line">read DSA key</span><br><span class="line">pub:</span><br><span class="line">    45:bb:18:f6:0e:b0:51:f9:d4:82:18:df:8c:d9:56:</span><br><span class="line">    33:0a:4f:f3:0a:f5:34:4f:6c:95:40:06:1d:53:83:</span><br><span class="line">    29:2d:95:c4:df:c8:ac:26:ca:45:2e:17:0d:c7:9b:</span><br><span class="line">    e1:5c:c6:15:9e:03:7b:cc:f5:64:ef:36:1c:18:c9:</span><br><span class="line">    9e:8a:eb:0b:c1:ac:f9:c0:c3:5d:62:0d:60:bb:73:</span><br><span class="line">    11:f1:cf:08:cf:bc:34:cc:aa:79:ef:1d:ad:8a:7a:</span><br><span class="line">    6f:ac:ce:86:65:90:06:d4:fa:f0:57:71:68:57:ec:</span><br><span class="line">    7c:a6:04:ad:e2:c3:d7:31:d6:d0:2f:93:31:98:d3:</span><br><span class="line">    90:c3:ef:c3:f3:ff:04:6f</span><br><span class="line">P:</span><br><span class="line">    00:c0:59:6c:3b:5e:93:3d:33:78:be:36:26:be:31:</span><br><span class="line">    5e:e7:0c:a6:b5:b1:1a:51:9b:55:23:d4:0e:5b:a7:</span><br><span class="line">    45:66:e2:2c:c8:8b:fe:c5:6a:ad:66:91:8b:9b:30:</span><br><span class="line">    ad:28:13:88:f0:bb:c6:b8:02:6b:7c:80:26:e9:11:</span><br><span class="line">    84:be:e0:c8:ad:10:cc:f2:96:be:cf:e5:05:05:38:</span><br><span class="line">    3c:b4:a9:54:b3:7c:b5:88:67:2f:7c:09:57:b6:fd:</span><br><span class="line">    f2:fa:05:38:fd:ad:83:93:4a:45:e4:f9:9d:38:de:</span><br><span class="line">    57:c0:8a:24:d0:0d:1c:c5:d5:fb:db:73:29:1c:d1:</span><br><span class="line">    0c:e7:57:68:90:b6:ba:08:9b</span><br><span class="line">Q:</span><br><span class="line">    00:86:8f:78:b8:c8:50:0b:eb:f6:7a:58:e3:3c:1f:</span><br><span class="line">    53:9d:35:70:d1:bd</span><br><span class="line">G:</span><br><span class="line">    4c:d5:e6:b6:6a:6e:b7:e9:27:94:e3:61:1f:41:53:</span><br><span class="line">    cb:11:af:5a:08:d9:d4:f8:a3:f2:50:03:72:91:ba:</span><br><span class="line">    5f:ff:3c:29:a8:c3:7b:c4:ee:5f:98:ec:17:f4:18:</span><br><span class="line">    bc:71:61:01:6c:94:c8:49:02:e4:00:3a:79:87:f0:</span><br><span class="line">    d8:cf:6a:61:c1:3a:fd:56:73:ca:a5:fb:41:15:08:</span><br><span class="line">    cd:b3:50:1b:df:f7:3e:74:79:25:f7:65:86:f4:07:</span><br><span class="line">    9f:ea:12:09:8b:34:50:84:4a:2a:9e:5d:0a:99:bd:</span><br><span class="line">    86:5e:05:70:d5:19:7d:f4:a1:c9:b8:01:8f:b9:9c:</span><br><span class="line">    dc:e9:15:7b:98:50:01:79</span><br></pre></td></tr></table></figure>
<p>读一下签名的值</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">➜  dsa openssl asn1parse -inform der -in packet1/sign1.bin</span><br><span class="line">    0:d=0  hl=2 l=  45 cons: SEQUENCE</span><br><span class="line">    2:d=1  hl=2 l=  21 prim: INTEGER           :8158B477C5AA033D650596E93653C730D26BA409</span><br><span class="line">   25:d=1  hl=2 l=  20 prim: INTEGER           :165B9DD1C93230C31111E5A4E6EB5181F990F702</span><br><span class="line">➜  dsa openssl asn1parse -inform der -in packet2/sign2.bin</span><br><span class="line">    0:d=0  hl=2 l=  44 cons: SEQUENCE</span><br><span class="line">    2:d=1  hl=2 l=  20 prim: INTEGER           :60B9F2A5BA689B802942D667ED5D1EED066C5A7F</span><br><span class="line">   24:d=1  hl=2 l=  20 prim: INTEGER           :3DC8921BA26B514F4D991A85482750E0225A15B5</span><br><span class="line">➜  dsa openssl asn1parse -inform der -in packet3/sign3.bin</span><br><span class="line">    0:d=0  hl=2 l=  44 cons: SEQUENCE</span><br><span class="line">    2:d=1  hl=2 l=  20 prim: INTEGER           :5090DA81FEDE048D706D80E0AC47701E5A9EF1CC</span><br><span class="line">   24:d=1  hl=2 l=  20 prim: INTEGER           :30EB88E6A4BFB1B16728A974210AE4E41B42677D</span><br><span class="line">➜  dsa openssl asn1parse -inform der -in packet4/sign4.bin</span><br><span class="line">    0:d=0  hl=2 l=  44 cons: SEQUENCE</span><br><span class="line">    2:d=1  hl=2 l=  20 prim: INTEGER           :5090DA81FEDE048D706D80E0AC47701E5A9EF1CC</span><br><span class="line">   24:d=1  hl=2 l=  20 prim: INTEGER           :5E10DED084203CCBCEC3356A2CA02FF318FD4123</span><br></pre></td></tr></table></figure>
<p>注意到3和4的<code>2:d=1  hl=2 l=  20 prim: INTEGER :</code>值一样，这里这个值代表签名结果中的r，下面一行为s。由于r一样，说明采用的随机数k一样，采用共享k攻击</p>
<p>这里读取dsa的公钥采用，需要从github上clone下来的，pip的这个函数阉割了，在虚拟机中读取</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.PublicKey import DSA</span><br><span class="line">with open(&apos;dsa/dsa_public.pem&apos;) as f:</span><br><span class="line">    key = DSA.importKey(f)</span><br><span class="line">    y = key.y</span><br><span class="line">    g = key.g</span><br><span class="line">    p = key.p</span><br><span class="line">    q = key.q</span><br></pre></td></tr></table></figure>
<p>然后攻击脚本</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">from hashlib import sha1</span><br><span class="line">import gmpy2</span><br><span class="line">p = 135072277349986231918767318777496371552998523256306836680207886328250469140725070958493165166375742776776188095739453689162118072119637932393028705045785456135605269009498175908369054264845986650254461451778502410559449967848738173219539609196568432769555817217073171835795353828043869976253611672766967842971L</span><br><span class="line">q = 768204286206312924745826772404361572053995803069L</span><br><span class="line">y = 48966667837013414801031811810642280772647236378744040304912885467993823167141281755249027785686488654582548005766785141294865650644124270468685164456792976944411071341740863520743350743985636739430430553599637295250998469649774667076175577773243724165204009991562726052681112720456820018391695334506416243823L</span><br><span class="line">g = 53955759259506195629370221955882028602129565196710167480649056988330906117971891319360466002581132965581793497788773734702624458318101767983345305577358509640139391448262692595149152168335401138516115001646783546740429454038931813085439969488499666706724464185937932560157850845046285161405028860099711467897L</span><br><span class="line">f3 = open(r&quot;dsa/packet3/message3&quot;, &apos;r&apos;)</span><br><span class="line">f4 = open(r&quot;dsa/packet4/message4&quot;, &apos;r&apos;)</span><br><span class="line">data3 = f3.read()</span><br><span class="line">data4 = f4.read()</span><br><span class="line">sha = sha1()</span><br><span class="line">sha.update(data3)</span><br><span class="line">m3 = int(sha.hexdigest(), 16)</span><br><span class="line">sha = sha1()</span><br><span class="line">sha.update(data4)</span><br><span class="line">m4 = int(sha.hexdigest(), 16)</span><br><span class="line">s3 = 0x30EB88E6A4BFB1B16728A974210AE4E41B42677D</span><br><span class="line">s4 = 0x5E10DED084203CCBCEC3356A2CA02FF318FD4123</span><br><span class="line">r = 0x5090DA81FEDE048D706D80E0AC47701E5A9EF1CC</span><br><span class="line">ds = s4 - s3</span><br><span class="line">dm = m4 - m3</span><br><span class="line">k = gmpy2.mul(dm, gmpy2.invert(ds, q))</span><br><span class="line">k = gmpy2.f_mod(k, q)</span><br><span class="line">tmp = gmpy2.mul(k, s3) - m3</span><br><span class="line">x = tmp * gmpy2.invert(r, q)</span><br><span class="line">x = gmpy2.f_mod(x, q)</span><br><span class="line">print &apos;CTF&#123;%d&#125;&apos; % int(x)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>CTF{520793588153805320783422521615148687785086070744}</p>
</blockquote>
<h1 id="Complicated-Crypto"><a href="#Complicated-Crypto" class="headerlink" title="Complicated Crypto"></a>Complicated Crypto</h1><blockquote>
<p>五层密码，好复杂</p>
<p>来源：sunnyelf</p>
</blockquote>
<h2 id="第一层：crc32爆破"><a href="#第一层：crc32爆破" class="headerlink" title="第一层：crc32爆破"></a>第一层：crc32爆破</h2><blockquote>
<p>crc32_util.py</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br></pre></td><td class="code"><pre><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line"></span><br><span class="line">import itertools</span><br><span class="line">import binascii</span><br><span class="line">import string</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class crc32_reverse_class(object):</span><br><span class="line">    def __init__(self, crc32, length, tbl=string.printable,</span><br><span class="line">                 poly=0xEDB88320, accum=0):</span><br><span class="line">        self.char_set = set(map(ord, tbl))</span><br><span class="line">        self.crc32 = crc32</span><br><span class="line">        self.length = length</span><br><span class="line">        self.poly = poly</span><br><span class="line">        self.accum = accum</span><br><span class="line">        self.table = []</span><br><span class="line">        self.table_reverse = []</span><br><span class="line"></span><br><span class="line">    def init_tables(self, poly, reverse=True):</span><br><span class="line">        # build CRC32 table</span><br><span class="line">        for i in range(256):</span><br><span class="line">            for j in range(8):</span><br><span class="line">                if i &amp; 1:</span><br><span class="line">                    i &gt;&gt;= 1</span><br><span class="line">                    i ^= poly</span><br><span class="line">                else:</span><br><span class="line">                    i &gt;&gt;= 1</span><br><span class="line">            self.table.append(i)</span><br><span class="line">        assert len(self.table) == 256, &quot;table is wrong size&quot;</span><br><span class="line">        # build reverse table</span><br><span class="line">        if reverse:</span><br><span class="line">            found_none = set()</span><br><span class="line">            found_multiple = set()</span><br><span class="line">            for i in range(256):</span><br><span class="line">                found = []</span><br><span class="line">                for j in range(256):</span><br><span class="line">                    if self.table[j] &gt;&gt; 24 == i:</span><br><span class="line">                        found.append(j)</span><br><span class="line">                self.table_reverse.append(tuple(found))</span><br><span class="line">                if not found:</span><br><span class="line">                    found_none.add(i)</span><br><span class="line">                elif len(found) &gt; 1:</span><br><span class="line">                    found_multiple.add(i)</span><br><span class="line">            assert len(self.table_reverse) == 256, &quot;reverse table is wrong size&quot;</span><br><span class="line"></span><br><span class="line">    def rangess(self, i):</span><br><span class="line">        return &apos;, &apos;.join(map(lambda x: &apos;[&#123;0&#125;,&#123;1&#125;]&apos;.format(*x), self.ranges(i)))</span><br><span class="line"></span><br><span class="line">    def ranges(self, i):</span><br><span class="line">        for kg in itertools.groupby(enumerate(i), lambda x: x[1] - x[0]):</span><br><span class="line">            g = list(kg[1])</span><br><span class="line">            yield g[0][1], g[-1][1]</span><br><span class="line"></span><br><span class="line">    def calc(self, data, accum=0):</span><br><span class="line">        accum = ~accum</span><br><span class="line">        for b in data:</span><br><span class="line">            accum = self.table[(accum ^ b) &amp; 0xFF] ^ (</span><br><span class="line">                (accum &gt;&gt; 8) &amp; 0x00FFFFFF)</span><br><span class="line">        accum = ~accum</span><br><span class="line">        return accum &amp; 0xFFFFFFFF</span><br><span class="line"></span><br><span class="line">    def findReverse(self, desired, accum):</span><br><span class="line">        solutions = set()</span><br><span class="line">        accum = ~accum</span><br><span class="line">        stack = [(~desired,)]</span><br><span class="line">        while stack:</span><br><span class="line">            node = stack.pop()</span><br><span class="line">            for j in self.table_reverse[(node[0] &gt;&gt; 24) &amp; 0xFF]:</span><br><span class="line">                if len(node) == 4:</span><br><span class="line">                    a = accum</span><br><span class="line">                    data = []</span><br><span class="line">                    node = node[1:] + (j,)</span><br><span class="line">                    for i in range(3, -1, -1):</span><br><span class="line">                        data.append((a ^ node[i]) &amp; 0xFF)</span><br><span class="line">                        a &gt;&gt;= 8</span><br><span class="line">                        a ^= self.table[node[i]]</span><br><span class="line">                    solutions.add(tuple(data))</span><br><span class="line">                else:</span><br><span class="line">                    stack.append(((node[0] ^ self.table[j]) &lt;&lt; 8,) + node[1:] + (j,))</span><br><span class="line">        return solutions</span><br><span class="line"></span><br><span class="line">    def dfs(self, length, outlist=[&apos;&apos;]):</span><br><span class="line">        tmp_list = []</span><br><span class="line">        if length == 0:</span><br><span class="line">            return outlist</span><br><span class="line">        for list_item in outlist:</span><br><span class="line">            tmp_list.extend([list_item + chr(x) for x in self.char_set])</span><br><span class="line">        return self.dfs(length - 1, tmp_list)</span><br><span class="line"></span><br><span class="line">    def run_reverse(self):</span><br><span class="line">        self.init_tables(self.poly)</span><br><span class="line">        desired = self.crc32</span><br><span class="line">        accum = self.accum</span><br><span class="line">        if self.length &gt;= 4:</span><br><span class="line">            patches = self.findReverse(desired, accum)</span><br><span class="line">            for patch in patches:</span><br><span class="line">                checksum = self.calc(patch, accum)</span><br><span class="line">                print &apos;verification checksum: 0x&#123;0:08x&#125; (&#123;1&#125;)&apos;.format(</span><br><span class="line">                    checksum, &apos;OK&apos; if checksum == desired else &apos;ERROR&apos;)</span><br><span class="line">            for item in self.dfs(self.length - 4):</span><br><span class="line">                patch = map(ord, item)</span><br><span class="line">                patches = self.findReverse(desired, self.calc(patch, accum))</span><br><span class="line">                for last_4_bytes in patches:</span><br><span class="line">                    if all(p in self.char_set for p in last_4_bytes):</span><br><span class="line">                        patch.extend(last_4_bytes)</span><br><span class="line">                        print &apos;[find]: &#123;1&#125; (&#123;0&#125;)&apos;.format(</span><br><span class="line">                            &apos;OK&apos; if self.calc(patch, accum) == desired else &apos;ERROR&apos;, &apos;&apos;.join(map(chr, patch)))</span><br><span class="line">        else:</span><br><span class="line">            for item in self.dfs(self.length):</span><br><span class="line">                if crc32(item) == desired:</span><br><span class="line">                    print &apos;[find]: &#123;0&#125; (OK)&apos;.format(item)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def crc32_reverse(crc32, length, char_set=string.printable,</span><br><span class="line">                  poly=0xEDB88320, accum=0):</span><br><span class="line">    obj = crc32_reverse_class(crc32, length, char_set, poly, accum)</span><br><span class="line">    obj.run_reverse()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def crc32(s):</span><br><span class="line">    return binascii.crc32(s) &amp; 0xffffffff</span><br></pre></td></tr></table></figure>
<blockquote>
<p>爆破脚本，注意6位的crc32碰撞有很多结果，手动缩小一下字典，这里先试了string.letters + string.digits，发现没有特别像密码的，再加个_到字典里就得到了</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">from crc32_util import *</span><br><span class="line"></span><br><span class="line">crc = [0x7C2DF918,</span><br><span class="line">       0xA58A1926,</span><br><span class="line">       0x4DAD5967]</span><br><span class="line"></span><br><span class="line">for i in crc:</span><br><span class="line">    crc32_reverse(i, 6, char_set=string.letters + string.digits + &apos;_&apos;)</span><br><span class="line"></span><br><span class="line"># _CRC32_i5_n0t_s4f3</span><br></pre></td></tr></table></figure>
<p>解出一个CRC32 Collision.7z，没有密码，直接解压得到</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">➜  CRC32 Collision tree</span><br><span class="line">.</span><br><span class="line">├── Find password.7z</span><br><span class="line">├── ciphertext.txt</span><br><span class="line">├── keys.txt</span><br><span class="line">└── tips.txt</span><br><span class="line"></span><br><span class="line">0 directories, 4 files</span><br></pre></td></tr></table></figure>
<h2 id="第二层：维吉尼亚"><a href="#第二层：维吉尼亚" class="headerlink" title="第二层：维吉尼亚"></a>第二层：维吉尼亚</h2><p>看一下每个文件的内容</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">➜  CRC32 Collision cat ciphertext.txt</span><br><span class="line">rla xymijgpf ppsoto wq u nncwel ff tfqlgnxwzz sgnlwduzmy vcyg ib bhfbe u tnaxua ff satzmpibf vszqen eyvlatq cnzhk dk hfy mnciuzj ou s yygusfp bl dq e okcvpa hmsz vi wdimyfqqjqubzc hmpmbgxifbgi qs lciyaktb jf clntkspy drywuz wucfm     </span><br><span class="line">➜  CRC32 Collision cat tips.txt</span><br><span class="line">你知道维吉尼亚密码吗？</span><br><span class="line">我们给了keys.txt，唯一的密钥就在其中，那么解密ciphertext.txt里的密文吧！</span><br><span class="line">解压密码就在明文里，祝你好运！</span><br><span class="line"></span><br><span class="line">Do you know the Vigenére Ciphers?</span><br><span class="line">We gave the keys.txt, Only have a key in it, So decrypts ciphertext.txt!</span><br><span class="line">Unzip Password in plaintext, good luck to you!</span><br></pre></td></tr></table></figure>
<p>还有几千行key</p>
<p>先在线解一下看看：<a href="https://guballa.de/vigenere-solver" target="_blank" rel="noopener">https://guballa.de/vigenere-solver</a></p>
<p><img src="http://oztni9daw.bkt.clouddn.com/13709fa94840b9957e9f4f9d17be042a.png" alt=""></p>
<p>结果不是太理想，看最后那里有个f开头某个单词，但是我们不知道是什么，不过可以看出个大概了，用关键字password爆破一下，最后密码换成小写加上空格</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">from pycipher import Vigenere</span><br><span class="line"></span><br><span class="line">with open(&apos;CRC32 Collision/keys.txt&apos;, &apos;r&apos;) as file:</span><br><span class="line">    for i in file.readlines():</span><br><span class="line">        m = Vigenere(i.strip()).decipher(</span><br><span class="line">            &apos;rla xymijgpf ppsoto wq u nncwel ff tfqlgnxwzz sgnlwduzmy vcyg ib bhfbe u tnaxua ff satzmpibf vszqen eyvlatq cnzhk dk hfy mnciuzj ou s yygusfp bl dq e okcvpa hmsz vi wdimyfqqjqubzc hmpmbgxifbgi qs lciyaktb jf clntkspy drywuz wucfm&apos;)</span><br><span class="line">        if &apos;PASSWORD&apos; in m:</span><br><span class="line">            print i, m</span><br><span class="line"># YEWCQGEWCYBNHDHPXOYUBJJPQIRAPSOUIYEOMTSV</span><br><span class="line"># THEVIGENERECIPHERISAMETHODOFENCRYPTINGALPHABETICTEXTBYUSINGASERIESOFDIFFERENTCAESARCIPHERSBASEDONTHELETTERSOFAKEYWORDITISASIMPLEFORMOFPOLYALPHABETICSUBSTITUTIONSOPASSWORDISVIGENERECIPHERFUNNY</span><br><span class="line"># vigenere cipher funny</span><br></pre></td></tr></table></figure>
<p>然后解压得到</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">➜  Find password tree</span><br><span class="line">.</span><br><span class="line">├── Easy SHA1.7z</span><br><span class="line">└── U need unzip password.txt</span><br><span class="line"></span><br><span class="line">0 directories, 2 files</span><br></pre></td></tr></table></figure>
<h2 id="第三层：sha1爆破"><a href="#第三层：sha1爆破" class="headerlink" title="第三层：sha1爆破"></a>第三层：sha1爆破</h2><p>txt的内容</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">恭喜!</span><br><span class="line"></span><br><span class="line">现在我们遇到一个问题,我们有一个zip文件,但我们不知道完整的解压密码。</span><br><span class="line">幸好我们知道解压密码的一部分sha1值。</span><br><span class="line">你能帮我们找到的密码吗?</span><br><span class="line"></span><br><span class="line">不完整的密码：&quot;*7*5-*4*3?&quot;  *代表可打印字符</span><br><span class="line"></span><br><span class="line">不完整的sha1：&quot;619c20c*a4de755*9be9a8b*b7cbfa5*e8b4365*&quot;  *代表可打印字符</span><br><span class="line"></span><br><span class="line">人生苦短，我用Python。</span><br><span class="line"></span><br><span class="line">Congratulations!</span><br><span class="line">Now we run into a problem,We have a zip file, but we don&apos;t know the complete unzip password.</span><br><span class="line">Fortunately, we know that part of the unzip password of sha1 value.</span><br><span class="line">can you help us to find the password?</span><br><span class="line"></span><br><span class="line">Incomplete password is &quot;*7*5-*4*3?&quot;   * in the range of ASCII printable characters</span><br><span class="line"></span><br><span class="line">Incomplete sha1 is &quot;619c20c*a4de755*9be9a8b*b7cbfa5*e8b4365*&quot;    * in the range of ASCII printable characters</span><br><span class="line"></span><br><span class="line">Life is short, you need Python.</span><br></pre></td></tr></table></figure>
<p>直接爆破</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">import hashlib</span><br><span class="line">import string</span><br><span class="line"></span><br><span class="line">sha1 = &quot;619c20c*a4de755*9be9a8b*b7cbfa5*e8b4365*&quot;</span><br><span class="line">pw = &quot;*7*5-*4*3?&quot;</span><br><span class="line">dic = string.printable</span><br><span class="line">for i in dic:</span><br><span class="line">    for j in dic:</span><br><span class="line">        for k in dic:</span><br><span class="line">            for l in dic:</span><br><span class="line">                pw = &apos;%s7%s5-%s4%s3?&apos; % (i, j, k, l)</span><br><span class="line">                sha11 = hashlib.sha1(pw).hexdigest()</span><br><span class="line">                if sha11[0:7] == sha1[0:7] and sha11[8:15] == sha1[8:15] and sha11[16:23] == sha1[16:23]:</span><br><span class="line">                    print pw, sha11</span><br><span class="line"># I7~5-s4F3? 619c20c4a4de75519be9a8b7b7cbfa54e8b4365b</span><br></pre></td></tr></table></figure>
<p>解压出来</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">➜  Easy SHA1 tree</span><br><span class="line">.</span><br><span class="line">├── MD5_is_really_safe? .txt</span><br><span class="line">└── Vulnerable RSA.7z</span><br><span class="line"></span><br><span class="line">0 directories, 2 files</span><br></pre></td></tr></table></figure>
<h2 id="第四层：md5碰撞"><a href="#第四层：md5碰撞" class="headerlink" title="第四层：md5碰撞"></a>第四层：md5碰撞</h2><p>txt内容为</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Hello World ;-)</span><br><span class="line">MD5校验真的安全吗？</span><br><span class="line">有没有两个不同的程序MD5却相同呢？</span><br><span class="line">如果有的话另一个程序输出是什么呢？</span><br><span class="line">解压密码为单行输出结果。</span><br><span class="line"></span><br><span class="line">Hello World ;-)</span><br><span class="line">MD5 check is really safe?</span><br><span class="line">There are two different procedures MD5 is the same?</span><br><span class="line">If so what is the output of another program?</span><br><span class="line">The decompression password is a single-line output.</span><br></pre></td></tr></table></figure>
<p>之前看过这个，就是有个输出<code>Hello World ;-)</code>的程序的md5碰撞，直接百度得到这篇文章</p>
<p><a href="http://blog.csdn.net/xiaofei0859/article/details/54924123" target="_blank" rel="noopener">blog.csdn.net/xiaofei0859/article/details/54924123</a></p>
<p>换到win10环境下载下来，运行得到结果</p>
<blockquote>
<p>Goodbye World :-(</p>
</blockquote>
<h2 id="第五层：RSA"><a href="#第五层：RSA" class="headerlink" title="第五层：RSA"></a>第五层：RSA</h2><p>历经艰辛，终于到最后一关了，这次终于没压缩包了</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">➜  Vulnerable RSA tree</span><br><span class="line">.</span><br><span class="line">├── flag.enc</span><br><span class="line">└── rsa_public_key.pem</span><br><span class="line"></span><br><span class="line">0 directories, 2 files</span><br></pre></td></tr></table></figure>
<p>读取公钥</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.PublicKey import RSA</span><br><span class="line">with open(&apos;Vulnerable RSA/rsa_public_key.pem&apos;, &apos;r&apos;) as f:</span><br><span class="line">    key = RSA.importKey(f)</span><br><span class="line">    n = key.n</span><br><span class="line">    e = key.e</span><br><span class="line">print n</span><br><span class="line">#460657813884289609896372056585544172485318117026246263899744329237492701820627219556007788200590119136173895989001382151536006853823326382892363143604314518686388786002989248800814861248595075326277099645338694977097459168530898776007293695728101976069423971696524237755227187061418202849911479124793990722597</span><br><span class="line">print e</span><br><span class="line">#354611102441307572056572181827925899198345350228753730931089393275463916544456626894245415096107834465778409532373187125318554614722599301791528916212839368121066035541008808261534500586023652767712271625785204280964688004680328300124849680477105302519377370092578107827116821391826210972320377614967547827619</span><br></pre></td></tr></table></figure>
<p>e特别大，那么一般d就特别小。在d比较小时，有两种攻击方法：</p>
<ul>
<li><code>d &lt; N^(1/4)/3</code>时，可以使用<code>wiener’s attack</code>来获得RSA的私钥。</li>
<li><code>d ≤ N^0.292</code>时， 我们可以利用<code>Boneh and Durfee attack</code>，在一定程度上该要攻击比wiener attack要强一些。</li>
</ul>
<h3 id="使用wiener’s-attack："><a href="#使用wiener’s-attack：" class="headerlink" title="使用wiener’s attack："></a>使用<code>wiener’s attack</code>：</h3><p>安装</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/pablocelayes/rsa-wiener-attack.git</span><br></pre></td></tr></table></figure>
<p>新建一个py文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">from RSAwienerHacker import hack_RSA</span><br><span class="line"></span><br><span class="line">n = 460657813884289609896372056585544172485318117026246263899744329237492701820627219556007788200590119136173895989001382151536006853823326382892363143604314518686388786002989248800814861248595075326277099645338694977097459168530898776007293695728101976069423971696524237755227187061418202849911479124793990722597</span><br><span class="line">e = 354611102441307572056572181827925899198345350228753730931089393275463916544456626894245415096107834465778409532373187125318554614722599301791528916212839368121066035541008808261534500586023652767712271625785204280964688004680328300124849680477105302519377370092578107827116821391826210972320377614967547827619</span><br><span class="line">print &apos;d = %d&apos; % hack_RSA(e, n)</span><br><span class="line"># d = 8264667972294275017293339772371783322168822149471976834221082393409363691895</span><br></pre></td></tr></table></figure>
<h3 id="使用Boneh-and-Durfee-attack："><a href="#使用Boneh-and-Durfee-attack：" class="headerlink" title="使用Boneh and Durfee attack："></a>使用<code>Boneh and Durfee attack</code>：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/mimoo/RSA-and-LLL-attacks.git</span><br></pre></td></tr></table></figure>
<p>然后修改<code>boneh_durfee.sage</code>中的<code>example()</code>中的<code>N</code>和<code>e</code>，然后运行sage</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">➜  RSA-and-LLL-attacks git:(master) ✗ sage boneh_durfee.sage</span><br><span class="line">=== checking values ===</span><br><span class="line">* delta: 0.180000000000000</span><br><span class="line">* delta &lt; 0.292 True</span><br><span class="line">* size of e: 1024</span><br><span class="line">* size of N: 1025</span><br><span class="line">* m: 4 , t: 2</span><br><span class="line">=== running algorithm ===</span><br><span class="line">* removing unhelpful vector 0</span><br><span class="line">6 / 18  vectors are not helpful</span><br><span class="line">det(L) &lt; e^(m*n) (good! If a solution exists &lt; N^delta, it will be found)</span><br><span class="line">00 X 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ~</span><br><span class="line">01 X X 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span><br><span class="line">02 0 0 X 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ~</span><br><span class="line">03 0 0 X X 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span><br><span class="line">04 0 0 X X X 0 0 0 0 0 0 0 0 0 0 0 0 0</span><br><span class="line">05 0 0 0 0 0 X 0 0 0 0 0 0 0 0 0 0 0 0 ~</span><br><span class="line">06 0 0 0 0 0 X X 0 0 0 0 0 0 0 0 0 0 0 ~</span><br><span class="line">07 0 0 0 0 0 X X X 0 0 0 0 0 0 0 0 0 0</span><br><span class="line">08 0 0 0 0 0 X X X X 0 0 0 0 0 0 0 0 0</span><br><span class="line">09 0 0 0 0 0 0 0 0 0 X 0 0 0 0 0 0 0 0 ~</span><br><span class="line">10 0 0 0 0 0 0 0 0 0 X X 0 0 0 0 0 0 0 ~</span><br><span class="line">11 0 0 0 0 0 0 0 0 0 X X X 0 0 0 0 0 0</span><br><span class="line">12 0 0 0 0 0 0 0 0 0 X X X X 0 0 0 0 0</span><br><span class="line">13 0 0 0 0 0 0 0 0 0 X X X X X 0 0 0 0</span><br><span class="line">14 X X 0 X X 0 0 0 0 0 0 0 0 0 X 0 0 0</span><br><span class="line">15 0 0 X X X 0 X X X 0 0 0 0 0 0 X 0 0</span><br><span class="line">16 0 0 0 0 0 X X X X 0 X X X X 0 0 X 0</span><br><span class="line">17 0 0 X X X 0 X X X 0 0 X X X 0 X X X</span><br><span class="line">optimizing basis of the lattice via LLL, this can take a long time</span><br><span class="line">LLL is done!</span><br><span class="line">looking for independent vectors in the lattice</span><br><span class="line">found them, using vectors 0 and 1</span><br><span class="line">=== solution found ===</span><br><span class="line">private key found: 8264667972294275017293339772371783322168822149471976834221082393409363691895</span><br><span class="line">=== 1.08708715439 seconds ===</span><br></pre></td></tr></table></figure>
<h3 id="解密flag"><a href="#解密flag" class="headerlink" title="解密flag"></a>解密flag</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.PublicKey import RSA</span><br><span class="line">from Crypto.Util.number import long_to_bytes</span><br><span class="line"></span><br><span class="line">with open(&apos;Vulnerable RSA/rsa_public_key.pem&apos;, &apos;r&apos;) as f:</span><br><span class="line">    key = RSA.importKey(f)</span><br><span class="line">    n = key.n</span><br><span class="line">    e = key.e</span><br><span class="line">d = 8264667972294275017293339772371783322168822149471976834221082393409363691895</span><br><span class="line">with open(&apos;Vulnerable RSA/flag.enc&apos;, &apos;r&apos;) as f:</span><br><span class="line">    c = f.read().encode(&apos;hex&apos;)</span><br><span class="line">    c = int(c, 16)</span><br><span class="line">m = pow(c, d, n)</span><br><span class="line">print long_to_bytes(m)</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">➜  crypto python Complicated_Crypto.py</span><br><span class="line">���W8��S/cwr�ӵCf��w�h	��d�D&#125;�7�!�;��w�Uf��%˖�B�&lt;&quot;QS��&#123;�.���z@���h硏��%&amp;���&apos;J�!�&apos;h8!Y�o(H�&#125;flag&#123;W0rld_Of_Crypt0gr@phy&#125;</span><br></pre></td></tr></table></figure>

      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/ctf/" rel="tag"># ctf</a>
          
            <a href="/tags/Jarvis-OJ/" rel="tag"># Jarvis OJ</a>
          
            <a href="/tags/writeup/" rel="tag"># writeup</a>
          
            <a href="/tags/crypto/" rel="tag"># crypto</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/11/30/sdr/" rel="next" title="HackRF入门">
                <i class="fa fa-chevron-left"></i> HackRF入门
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2017/12/04/kali/" rel="prev" title="MACos安装kali及环境配置">
                MACos安装kali及环境配置 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/billy-christian-smoking-mob.jpg"
                alt="4Five" />
            
              <p class="site-author-name" itemprop="name">4Five</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">8</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  <a href="/categories/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">6</span>
                    <span class="site-state-item-name">分类</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  <a href="/tags/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">12</span>
                    <span class="site-state-item-name">标签</span>
                  </a>
                </div>
              
            </nav>
          

          

          

          
          

          
          

          
            
          
          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Jarvis’s-encryption-system"><span class="nav-number">1.</span> <span class="nav-text">Jarvis’s encryption system</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#影之密码"><span class="nav-number">2.</span> <span class="nav-text">影之密码</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#好多盐"><span class="nav-number">3.</span> <span class="nav-text">好多盐</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#superexpress"><span class="nav-number">4.</span> <span class="nav-text">superexpress</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#vigenere"><span class="nav-number">5.</span> <span class="nav-text">vigenere</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#DSA"><span class="nav-number">6.</span> <span class="nav-text">DSA</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Complicated-Crypto"><span class="nav-number">7.</span> <span class="nav-text">Complicated Crypto</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#第一层：crc32爆破"><span class="nav-number">7.1.</span> <span class="nav-text">第一层：crc32爆破</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#第二层：维吉尼亚"><span class="nav-number">7.2.</span> <span class="nav-text">第二层：维吉尼亚</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#第三层：sha1爆破"><span class="nav-number">7.3.</span> <span class="nav-text">第三层：sha1爆破</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#第四层：md5碰撞"><span class="nav-number">7.4.</span> <span class="nav-text">第四层：md5碰撞</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#第五层：RSA"><span class="nav-number">7.5.</span> <span class="nav-text">第五层：RSA</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#使用wiener’s-attack："><span class="nav-number">7.5.1.</span> <span class="nav-text">使用wiener’s attack：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#使用Boneh-and-Durfee-attack："><span class="nav-number">7.5.2.</span> <span class="nav-text">使用Boneh and Durfee attack：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#解密flag"><span class="nav-number">7.5.3.</span> <span class="nav-text">解密flag</span></a></li></ol></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">4Five</span>

  

  
</div>




  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动 v3.4.4</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://theme-next.org">NexT.Gemini</a> v6.3.0</div>




        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


















  
  









  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/three/three.min.js"></script>
  

  
  
    <script type="text/javascript" src="/lib/three/canvas_lines.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=6.3.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=6.3.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=6.3.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=6.3.0"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=6.3.0"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=6.3.0"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=6.3.0"></script>



  



  





  










  





  

  

  

  

  
  

  

  

  

  

  

</body>
</html>
